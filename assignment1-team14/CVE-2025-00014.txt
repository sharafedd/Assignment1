CVE ID: CVE-2025-00014
Title: Buffer Overflow in evilcorp_js v0.1.2.1
Date Assigned: 2025-11-17

Researchers:
    - Sharaf E. Boukhezer
    - Wai Lee Boo

Affected Product:
    - Vendor: EvilCorp  
    - Product: evilcorp_js  
    - Version: 0.1.2.1

CPE:
    cpe:2.3:a:evilcorp:evilcorp_js:0.1.2.1:*:*:*:*:*:*:*

Vulnerability Type:
    Buffer Overflow

---

Description:

A stack-based buffer overflow exists in evilcorp_js version 0.1.2.1. when processinging let declarations, the interpreter copies identifier text from current.text into a fixed-size stack buffer (char name[64]) using strcpy() without validating the input length. Because the identifier is fully controlled by the input file, an oversized token can write past the bounds of the destination array.


Technical Details:

The vulnerability occurs in parse_statement() at line 148:

144 void parse_statement() {
145     if (current.type == TOKEN_LET) {
...
148         char name[64]; strcpy(name, current.text); // ← No bounds check (buffer overflow)
...

current.text is sourced directly from user input, but the parser performs no length validation before copying it into the 64-byte name buffer. An oversized identifier overflows the stack frame, corrupting adjacent memory. AFL++ fuzzing repeatedly triggered SIGSEGV, confirming deterministic stack corruption.


Impact: 

An attacker can supply a malicious input file to trigger a crash. This corrupts the interpreter’s internal state and reliably terminates execution (denial of service). Because the overflow occurs on a stack frame adjacent to control-flow data, it also represents a theoretical vector for arbitrary code execution under weakened compiler or platform protections.


CVSS v3.1 Score:

Overall Score: 7.7 (Rating: High)
Vector: AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:U/RL:U/RC:C


Reproduction Steps:

1. Compile the vulnerable version:
    clang -g -O0 js.c -o js
2. Create maliscious input (crash_input.txt):
    let aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa = 10;
3. Run:
    ./js crash_input.txt
4. Observe the crash:
    Segmentation fault (core dumped)


Patch:

Replace strcpy() with a bounded copy (strncpy()) and add a length check to reject identifiers longer than 63 bytes:

...
148          char name[64]; 
149          strncpy(name, current.text, sizeof(name) - 1);
150          name[sizeof(name) - 1] = '\0'; // enforce null-termination
...

Avoid processing untrusted files. Compiler protections such as stack canaries and ASLR should also be enabled.

---

Credits:
    This vulnerability was discovered and patched by:
        - Sharaf E. Boukhezer
        - Wai Lee Boo

University of Birmingham - Secure Software & Hardware Systems Coursework [34240]

